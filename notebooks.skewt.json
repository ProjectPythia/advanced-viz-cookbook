{"version":2,"kind":"Notebook","sha256":"d2460b3683e1c1be1adf07f32b05d5fbbd49ac4e6afde5ca9afa568599d2fa62","slug":"notebooks.skewt","location":"/notebooks/5-skewt.ipynb","dependencies":[],"frontmatter":{"title":"Skew T Diagrams","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"The Project Pythia Community","given":"The Project Pythia","family":"Community"},"name":"The Project Pythia Community","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/advanced-viz-cookbook","copyright":"2024","affiliations":[{"id":"University at Albany (State University of New York)","name":"University at Albany (State University of New York)"},{"id":"UCAR/NCAR","name":"UCAR/NCAR"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/advanced-viz-cookbook/blob/main/notebooks/5-skewt.ipynb","exports":[{"format":"ipynb","filename":"5-skewt.ipynb","url":"/advanced-viz-cookbook/build/5-skewt-4ca93f7ba0896f1e70c029461f2755b5.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UXPvVxq7mv"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"XMLBbfkIGF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Skew-T plots are effectively thermodynamic diagrams used in meteorology. They display data collected from radiosonde balloons collecting atmospheric data including pressure level, temperature, relative humidity, and wind speed and direction.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t7VU26yc8L"}],"key":"qodoOUXgbX"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this notebook, we’ll learn about the structural and data components of Skew-T diagrams and how to plot them in Python using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mVqj9EmI1y"},{"type":"link","url":"https://unidata.github.io/MetPy/latest/index.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"MetPy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JXLG6miGz8"}],"urlSource":"https://unidata.github.io/MetPy/latest/index.html","key":"pBvI3r9Tnc"},{"type":"text","value":" package.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eEPYo3KR2G"}],"key":"i5U8Bxgf8E"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Elements of a Skew-T Diagram","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jV5yb2plnp"}],"key":"jjKGKSqWpM"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Acquiring Sounding Data","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"zCQfrJpD4q"}],"key":"oycmmx7YWD"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Making a Skew-T plot in Python (with MetPy!)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Se2qh6nLMe"}],"key":"ZWDe6WOPmp"}],"key":"OMGP8qsWko"}],"key":"kB17eUVWa6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NwMEJsVnsm"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"zWDAzhrzUs"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z2h6hgsezB"}],"key":"GeFPnY68U3"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G9Q9FlJlNT"}],"key":"h3Uz4gdqSK"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TlWncCAG3U"}],"key":"cvoOJjybfY"}],"key":"QMmTsxjBJo"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/matplotlib.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Matplotlib","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jECLohmo1H"}],"urlSource":"https://foundations.projectpythia.org/core/matplotlib.html","key":"vjZw5ZnBzj"}],"key":"ckatIkjzj1"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DMvLXqKYBV"}],"key":"ZLzgfs4iE2"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"cQr2Z5HoBd"}],"key":"ochGuQ7Q70"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://unidata.github.io/MetPy/latest/index.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Metpy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BB7vJWuxJH"}],"urlSource":"https://unidata.github.io/MetPy/latest/index.html","key":"tRBWyD1fSb"}],"key":"GDFqBxfMeD"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Useful","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DMfxtc6tvD"}],"key":"y3i3WfDBeS"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[],"key":"MwUQOP7Zgf"}],"key":"vDQk8SJTeZ"}],"key":"GT6dUt0qhy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"uXLrjq08iQ"}],"key":"u7JYyJZWWI"},{"type":"text","value":": 10 minutes","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LyfAnen7WG"}],"key":"m1FIn3i7Sa"}],"key":"sFoH7pOGJk"},{"type":"thematicBreak","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oakn6X9MsK"}],"key":"jjPTpi16MY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Elements of a Skew-T Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gzfiMD3IBJ"}],"identifier":"elements-of-a-skew-t-plot","label":"Elements of a Skew-T Plot","html_id":"elements-of-a-skew-t-plot","implicit":true,"key":"xeorYO9mBh"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Let’s start out by talking about the structural elements of a Skew-T plot.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"F7VWTr62N6"}],"key":"fPeTuJdXdj"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Temperature Lines","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VNObh2SVDK"}],"key":"Ekfft3mpsI"},{"type":"text","value":" are drawn at an angle up from the x-axis and are where the name “Skew-T” comes from.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"V1KtJ0fehs"}],"key":"e2O9SvcVHJ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Pressure Lines","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mIdbdra2XG"}],"key":"A0W7DbCI1B"},{"type":"text","value":" are horizontal from the y-axis, where pressure is plotted at a logarithmic scale.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Lvw4uLNV33"}],"key":"wOygsvlND4"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Dry Adiabats","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"a5eQilP76m"}],"key":"dGPkBjDrm9"},{"type":"text","value":": are lines of constant potential temperature as hypothetical air with no moisture content rises isentropically (with constant entropy).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"OyO0SrnTCv"}],"key":"OAxZQRidz6"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Moist Adiabats","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eUJwo2QGXD"}],"key":"vvSvBawBNV"},{"type":"text","value":": are lines of constant equivalent potential temperature - the change in temperature of fully saturated air as it rises, undergoing cooling due to adiabatic expansion.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"J7ijfPudY3"}],"key":"V4b13PftPI"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Mixing Ratio Lines","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Kvlbfj1dZ8"}],"key":"LwtrD8isTd"},{"type":"text","value":": represent lines of constant mixing ratio, the mass of water vapor relative to the mass of dry air.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"uRrvO32eYg"}],"key":"PrWXOEUznN"}],"key":"wH3nNstHL7"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"On all those structural elements, Skew-T plots have two lines plotted on them, ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MjpXlIYxzO"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"air temperature","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Co1itd2ktR"}],"key":"SPgVybYndC"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"h6LmDE4fbj"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"dew point","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"VRR5bg0CB0"}],"key":"FzErO3eQOG"},{"type":"text","value":". In this notebook, we’ll be plotting the air temperature in red and the dew point in blue.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"awhtbFmwPi"}],"key":"UbXvlKgZko"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Additionally, Skew-T plots have ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fr6BSnVv86"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"wind barbs","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"YhGPGw4HCg"}],"key":"kGQ1q8Fj62"},{"type":"text","value":". These describe the wind speed and direction at different pressure levels and are plotted on the right side of the diagram.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Lm9D6TJCG5"}],"key":"j3I1sdaZ1s"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"d5v3cIbGTZ"}],"key":"bT8uNe4QZQ"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"For a more detailed description and a cool interactive diagram, visit ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BOMRXWi5Op"},{"type":"link","url":"https://www.noaa.gov/jetstream/upperair/skew-t-log-p-diagrams","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"NOAA’s Skew-T page","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"UaSq3gioky"}],"urlSource":"https://www.noaa.gov/jetstream/upperair/skew-t-log-p-diagrams","key":"bVdJB1Orbk"},{"type":"text","value":".","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"lTs9vhLXM1"}],"key":"idGoz1Zwy2"}],"key":"NNXV3cwPam"}],"key":"Mb2OGoRPJY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom mpl_toolkits.axes_grid1.inset_locator import inset_axes\nimport pandas as pd\n\nfrom metpy.plots import SkewT, Hodograph\nimport metpy.calc as mpcalc\nfrom metpy.units import units","key":"cAykkzISwa"},{"type":"output","id":"GX6AhnwoHFFsaKVXgqBsQ","data":[],"key":"oP4EXCvEZf"}],"key":"L9TkvNLITr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acquiring Sounding Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KbekXYxrez"}],"identifier":"acquiring-sounding-data","label":"Acquiring Sounding Data","html_id":"acquiring-sounding-data","implicit":true,"key":"AjiIlTdaRM"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"If you want to get your own sounding data, run the following code in a new cell using the date and station of your choice:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"s6qNqMlR2C"}],"key":"scnYnmNaav"},{"type":"code","lang":"python","value":"from datetime import datetime\nfrom siphon.simplewebservice.wyoming import WyomingUpperAir\n\ndate = datetime(2023, 7, 7, 0)\nstation = 'JAX'\ndf = WyomingUpperAir.request_data(date, station)","position":{"start":{"line":4,"column":1},"end":{"line":11,"column":1}},"key":"q4Nzss68ch"}],"key":"qfI5OLaaRX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We’ve already done this for you and saved the data in a file, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Aj7IjR5O6k"},{"type":"inlineCode","value":"notebooks/data/jax_sounding.csv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A2VfxoPag5"},{"type":"text","value":" for you to use. We’ll use that file’s data for the rest of the notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"brN8puRLC7"}],"key":"IZVXNGNYn0"}],"key":"nwTrHKEoLm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df = pd.read_csv('data/jax_sounding.csv')\ndf","key":"hxcsH77rtw"},{"type":"output","id":"vBbLtgJ9sdtFk0b-zJH31","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"     pressure   height  temperature  dewpoint  direction  speed     u_wind  \\\n0      1012.0      9.0         24.8      23.6          0      0   0.000000   \n1      1003.0     88.0         26.3      22.6        210     14   7.000000   \n2      1000.0    115.0         26.8      22.2        210     14   7.000000   \n3       993.0    177.0         26.8      21.8        200     14   4.788282   \n4       986.0    240.0         26.6      20.8        190     14   2.431074   \n..        ...      ...          ...       ...        ...    ...        ...   \n130      11.0  30681.0        -45.0     -79.0         70     29 -27.251086   \n131      10.4  31057.0        -44.3     -78.3         79     33 -32.393697   \n132      10.0  31320.0        -44.7     -78.7         85     36 -35.863009   \n133       9.4  31735.0        -43.7     -77.7         85     37 -36.859204   \n134       9.0      NaN          NaN       NaN         85     37 -36.859204   \n\n        v_wind station  station_number        time  latitude  longitude  \\\n0     0.000000     JAX           72206  2023-07-07      30.5      -81.7   \n1    12.124356     JAX           72206  2023-07-07      30.5      -81.7   \n2    12.124356     JAX           72206  2023-07-07      30.5      -81.7   \n3    13.155697     JAX           72206  2023-07-07      30.5      -81.7   \n4    13.787309     JAX           72206  2023-07-07      30.5      -81.7   \n..         ...     ...             ...         ...       ...        ...   \n130  -9.918584     JAX           72206  2023-07-07      30.5      -81.7   \n131  -6.296697     JAX           72206  2023-07-07      30.5      -81.7   \n132  -3.137607     JAX           72206  2023-07-07      30.5      -81.7   \n133  -3.224762     JAX           72206  2023-07-07      30.5      -81.7   \n134  -3.224762     JAX           72206  2023-07-07      30.5      -81.7   \n\n     elevation     pw  \n0          9.0  58.42  \n1          9.0  58.42  \n2          9.0  58.42  \n3          9.0  58.42  \n4          9.0  58.42  \n..         ...    ...  \n130        9.0  58.42  \n131        9.0  58.42  \n132        9.0  58.42  \n133        9.0  58.42  \n134        9.0  58.42  \n\n[135 rows x 15 columns]","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>pressure</th>\n      <th>height</th>\n      <th>temperature</th>\n      <th>dewpoint</th>\n      <th>direction</th>\n      <th>speed</th>\n      <th>u_wind</th>\n      <th>v_wind</th>\n      <th>station</th>\n      <th>station_number</th>\n      <th>time</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>elevation</th>\n      <th>pw</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1012.0</td>\n      <td>9.0</td>\n      <td>24.8</td>\n      <td>23.6</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1003.0</td>\n      <td>88.0</td>\n      <td>26.3</td>\n      <td>22.6</td>\n      <td>210</td>\n      <td>14</td>\n      <td>7.000000</td>\n      <td>12.124356</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1000.0</td>\n      <td>115.0</td>\n      <td>26.8</td>\n      <td>22.2</td>\n      <td>210</td>\n      <td>14</td>\n      <td>7.000000</td>\n      <td>12.124356</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>993.0</td>\n      <td>177.0</td>\n      <td>26.8</td>\n      <td>21.8</td>\n      <td>200</td>\n      <td>14</td>\n      <td>4.788282</td>\n      <td>13.155697</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>986.0</td>\n      <td>240.0</td>\n      <td>26.6</td>\n      <td>20.8</td>\n      <td>190</td>\n      <td>14</td>\n      <td>2.431074</td>\n      <td>13.787309</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>130</th>\n      <td>11.0</td>\n      <td>30681.0</td>\n      <td>-45.0</td>\n      <td>-79.0</td>\n      <td>70</td>\n      <td>29</td>\n      <td>-27.251086</td>\n      <td>-9.918584</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n    <tr>\n      <th>131</th>\n      <td>10.4</td>\n      <td>31057.0</td>\n      <td>-44.3</td>\n      <td>-78.3</td>\n      <td>79</td>\n      <td>33</td>\n      <td>-32.393697</td>\n      <td>-6.296697</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n    <tr>\n      <th>132</th>\n      <td>10.0</td>\n      <td>31320.0</td>\n      <td>-44.7</td>\n      <td>-78.7</td>\n      <td>85</td>\n      <td>36</td>\n      <td>-35.863009</td>\n      <td>-3.137607</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n    <tr>\n      <th>133</th>\n      <td>9.4</td>\n      <td>31735.0</td>\n      <td>-43.7</td>\n      <td>-77.7</td>\n      <td>85</td>\n      <td>37</td>\n      <td>-36.859204</td>\n      <td>-3.224762</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n    <tr>\n      <th>134</th>\n      <td>9.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>85</td>\n      <td>37</td>\n      <td>-36.859204</td>\n      <td>-3.224762</td>\n      <td>JAX</td>\n      <td>72206</td>\n      <td>2023-07-07</td>\n      <td>30.5</td>\n      <td>-81.7</td>\n      <td>9.0</td>\n      <td>58.42</td>\n    </tr>\n  </tbody>\n</table>\n<p>135 rows × 15 columns</p>\n</div>","content_type":"text/html"}}}],"key":"Ou2KqgvkAC"}],"key":"hYKhZk9qs8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"h = df['height'].values\np = df['pressure'].values\nT = df['temperature'].values\nTd = df['dewpoint'].values\nu = df['u_wind'].values\nv = df['v_wind'].values","key":"z8ImOdyMqy"},{"type":"output","id":"jO855DQ7nvISsGPhczUq-","data":[],"key":"zfWeevyUKq"}],"key":"HafZg85IHK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Making a Skew-T plot in Python (with MetPy!)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rO1guVvR6q"}],"identifier":"making-a-skew-t-plot-in-python-with-metpy","label":"Making a Skew-T plot in Python (with MetPy!)","html_id":"making-a-skew-t-plot-in-python-with-metpy","implicit":true,"key":"Cdh2DRKOWE"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"So, all of that might seem a little abstract without a visual. We’re going to use MetPy’s SkewT module to make an actual Skew-T plot with the sounding data we downloaded earlier.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YhrFjN6gqM"}],"key":"mMxx0ciSjW"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"From the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jnebZ3vK7f"},{"type":"link","url":"https://unidata.github.io/MetPy/latest/api/generated/metpy.plots.SkewT.html","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"MetPy documentation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WzJGwhWMZC"}],"urlSource":"https://unidata.github.io/MetPy/latest/api/generated/metpy.plots.SkewT.html","key":"hJaQl5PWl7"},{"type":"text","value":":","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zs9UvUHLxW"}],"key":"cvZzjAXP8W"},{"type":"blockquote","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"“This class simplifies the process of creating Skew-T log-P plots in using matplotlib. It handles requesting the appropriate skewed projection, and provides simplified wrappers to make it easy to plot data, add wind barbs, and add other lines to the plots (e.g. dry adiabats)”","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Uz8IaNJapP"}],"key":"rkQrXNCYrN"}],"key":"V17WNjzSUl"},{"type":"heading","depth":3,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Just the basics","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"V1YEtHReNO"}],"identifier":"just-the-basics","label":"Just the basics","html_id":"just-the-basics","implicit":true,"key":"PvYRWHdLx2"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"To start with, let’s create a very minimal Skew-T plot with just the pressure and temperature lines under the sounding data.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"R4Q51ROYIV"}],"key":"QPLQO417UH"}],"key":"KF5IYdscXu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# make figure and `SkewT` object\nfig = plt.figure(figsize=(9, 9))\nskewt = SkewT(fig=fig, rotation=45)\n\n# plot sounding data\nskewt.plot(p, T, 'r')  # air temperature\nskewt.plot(p, Td, 'b')  # dew point\nskewt.plot_barbs(p[p >= 100], u[p >= 100], v[p >= 100])  # wind barbs","key":"Px3H9DeZTB"},{"type":"output","id":"MVgAzGrnFG9YmX9cnpKob","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8bbd9c70cf5ab920dd1abe0a5c93a8fe","path":"/advanced-viz-cookbook/build/8bbd9c70cf5ab920dd1abe0a5c93a8fe.png"}}}],"key":"zt2uRimTse"}],"key":"wwbfs2jVGh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s talk break that down a bit.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TTvm3ybmt3"}],"key":"dTXXdPK12K"},{"type":"code","lang":"python","value":"# make figure and `SkewT` object\nfig = plt.figure(figsize=(9, 9))\nskewt = SkewT(fig=fig, rotation=45)","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"key":"F1K3bvO8bW"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"First, we made a new figure and used it to make a new skew-T plot. If you don’t provide a figure to ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"z3EnrFYP3H"},{"type":"inlineCode","value":"SkewT","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EaCjSnkGgv"},{"type":"text","value":", one will be created for you, but it’s useful to make the default figure size a bit larger for this tutorial.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"I6KUbLmqlc"}],"key":"WHvNNoZwwG"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Additionally, we’ve also set the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"sc77Tk0Ygy"},{"type":"inlineCode","value":"rotation","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"LhBRrbcyuP"},{"type":"text","value":" kwarg to be 45 degrees. This is the angle that the temperature lines will be drawn at. ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"UghFA3SY3v"},{"type":"inlineCode","value":"MetPy","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fYuk4NDobK"},{"type":"text","value":"’s default is 30 degrees, but we’re going to use a more traditional 45 degrees for this tutorial.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"wDsTADg5j8"}],"key":"FE9Rv6I3zB"},{"type":"code","lang":"python","value":"# plot sounding data\nskewt.plot(p, T, 'r') # air temperature\nskewt.plot(p, Td, 'b') # dew point","position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"key":"VO4D5zG4Z1"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"For air temperature and dew point, we can use the standard ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"g9Jx9tluSQ"},{"type":"inlineCode","value":"plot","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"lLo1VWPGIC"},{"type":"text","value":" method. The ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"HLixZ8joPD"},{"type":"inlineCode","value":"SkewT","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"r3pBaKgjZN"},{"type":"text","value":" object provides a wrapper around matplotlib’s ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"xKPMhZc3HW"},{"type":"inlineCode","value":"plot","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"fTYcBJLTLy"},{"type":"text","value":" method, and can be used in the same way. Note that even though pressure is on the y-axis, we still provide it as the first argument to ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"M3SpBukGme"},{"type":"inlineCode","value":"plot","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"BdEpYeHjzs"},{"type":"text","value":" because it is the independent variable.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"hsCUfdmOEC"}],"key":"XUNx4ypz3o"},{"type":"code","lang":"python","value":"skewt.plot_barbs(p[p >= 100], u[p >= 100], v[p >= 100]) # wind barbs","position":{"start":{"line":20,"column":1},"end":{"line":22,"column":1}},"key":"Qe9gIvQq40"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Finally, we use ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"LrfvpMZL7M"},{"type":"inlineCode","value":"SkewT","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"iwWLL9VeRF"},{"type":"text","value":"’s ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"hRi0G0EHqN"},{"type":"link","url":"https://unidata.github.io/MetPy/latest/api/generated/metpy.plots.SkewT.html#metpy.plots.SkewT.plot_barbs","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"inlineCode","value":"plot_barbs","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"eyQhvt7xqy"}],"urlSource":"https://unidata.github.io/MetPy/latest/api/generated/metpy.plots.SkewT.html#metpy.plots.SkewT.plot_barbs","key":"Md8c2zaAVH"},{"type":"text","value":" method to add the wind barbs to the right side of the plot. This is a wrapper around matplotlib’s ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"onMWLwRJ1O"},{"type":"link","url":"https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.barbs.html#matplotlib.pyplot.barbs","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"inlineCode","value":"barbs","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"GHWH7ZnJrr"}],"urlSource":"https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.barbs.html#matplotlib.pyplot.barbs","key":"x20Egh0DJf"},{"type":"text","value":" method that applies the appropriate transformation and positions the barbs as expected for a Skew-T plot. Note that we only plot the wind barbs for pressure levels greater than 100 hPa. This is just to keep the wind barbs from extending off the plot.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"LO7pn47vip"}],"key":"U3S6bs5L9d"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"In addition to the elements we have added specifically, you can see that the ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"zKGq3ZuO5h"},{"type":"inlineCode","value":"SkewT","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"DufAXWjD0u"},{"type":"text","value":" object also added some of the structural elements we discussed previously. By default, ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"h8H7egIGO8"},{"type":"inlineCode","value":"SkewT","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"gq18oIEhrK"},{"type":"text","value":" adds the horizontal pressure and skewed temperature lines.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"oA2GMsOTCC"}],"key":"ZrkxA7REZ4"}],"key":"Wcaf5sZOHu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Adding more structural elements","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Za8DlI4iLN"}],"identifier":"adding-more-structural-elements","label":"Adding more structural elements","html_id":"adding-more-structural-elements","implicit":true,"key":"l7qCYiKwfW"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Next, let’s add the rest of the structural elements to the plot.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kcho4h5lf0"}],"key":"IVBTUoQQQK"}],"key":"Bk31ybuN0x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# make figure and `SkewT` object\nfig = plt.figure(figsize=(9, 9))\nskewt = SkewT(fig=fig, rotation=45)\n\n# plot sounding data\nskewt.plot(p, T, 'r') # air temperature\nskewt.plot(p, Td, 'b') # dew point\nskewt.plot_barbs(p[p >= 100], u[p >= 100], v[p >= 100])  # wind barbs\n\n# add dry adiabats, moist adiabats, and mixing ratio lines\nskewt.plot_dry_adiabats()\nskewt.plot_moist_adiabats()\nskewt.plot_mixing_lines()\n","key":"l1uckwoZp0"},{"type":"output","id":"9Dddm4lNMa0UI_EYjMynH","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d54dd91c316ed08fc083f4ba284a5de6","path":"/advanced-viz-cookbook/build/d54dd91c316ed08fc083f4ba284a5de6.png"}}}],"key":"iTSRVSJzdB"}],"key":"VYAlpk8RYC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Similarly to the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L6FlSwytdO"},{"type":"inlineCode","value":"plot_barbs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZSFqR0lrtT"},{"type":"text","value":" command, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LwVItAvcde"},{"type":"inlineCode","value":"SkewT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vuj6xgwVue"},{"type":"text","value":" object provides convenient methods for adding the remaining structural elements to the plot.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sVFr0DNCuM"}],"key":"Jnh3F8vi07"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The default appearance of these elements is:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SULGBjFWXG"}],"key":"a2d47LYqmk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dry Adiabats","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kPy8oIKjEH"}],"key":"xJtXvy4OkQ"},{"type":"text","value":": dashed red/pinkish lines with an alpha value of 0.5","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Uc0WKa8cjS"}],"key":"FyHeKtxxWq"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Moist Adiabats","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oqMgUphzWv"}],"key":"s0AlSWbr5Y"},{"type":"text","value":": dashed blue lines with an alpha value of 0.5","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XNVqVObtDP"}],"key":"FkO0D0Wzbd"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Mixing Ratio Lines","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"R8AKpelUpH"}],"key":"IsuF6kC6K5"},{"type":"text","value":": dashed green lines with an alpha value of 0.8","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DYRbh8IzRa"}],"key":"HO9cGvhddC"}],"key":"isJbuY9PyA"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"These defaults can be overwritten by providing additional keyword arguments to the methods.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"klfNauxSnZ"}],"key":"UEjmu7Mxcr"}],"key":"h7mGpT65N2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Polishing the plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sWMRdS0pqv"}],"identifier":"polishing-the-plot","label":"Polishing the plot","html_id":"polishing-the-plot","implicit":true,"key":"xsVnrApZuk"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now that we have all the structural elements on the plot, let’s make it look a little nicer. The previous plot has all the necessary information, but it’s a little cluttered and hard to read.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VrrX8KA8Bv"}],"key":"w104i8tosW"}],"key":"I3vLEj1OZI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# make figure and `SkewT` object\nfig = plt.figure(figsize=(8,12))\nskewt = SkewT(fig=fig)\nskewt.ax.set_ylim(1000, 10)\n\n# plot sounding data\nskewt.plot(p, T, 'r') # air temperature\nskewt.plot(p, Td, 'b') # dew point\nskewt.plot_barbs(p[::5], u[::5], v[::5]) # add a wind barb every fifth level\n\n# add dry adiabats, moist adiabats, and mixing ratio lines\nskewt.plot_dry_adiabats(linewidth=0.5)\nskewt.plot_moist_adiabats(linewidth=0.5)\nskewt.plot_mixing_lines(linewidth=0.5)\n\n# add axis and figure titles\nplt.title(df['station'][0] + ' ' + str(df['time'][0]))\nplt.xlabel('temperature (degC)')\nplt.ylabel('pressure (hPa)')","key":"nybD5FC33g"},{"type":"output","id":"V4UPnhccsgEyGqZAvcIRw","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x1200 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"54208e71f69dcf6f33b38d6daf03cd80","path":"/advanced-viz-cookbook/build/54208e71f69dcf6f33b38d6daf03cd80.png"}}}],"key":"MKVWAwP7hR"}],"key":"Y8IxtlA8lL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, we’ve made the following changes:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CWyUT7NooQ"}],"key":"wNgm7dnvnI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"changed the figsize to ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fZ1DIMG27W"},{"type":"inlineCode","value":"figsize=(8,12)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oAXXFn3dYX"}],"key":"xyjoy2KfR2"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"removed the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"swIvwxT21c"},{"type":"inlineCode","value":"rotation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XWKT9ojVqd"},{"type":"text","value":" kwarg from the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O3HTLgNLft"},{"type":"inlineCode","value":"SkewT","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZCr1ru06sO"},{"type":"text","value":" object to allow the upper air temp and dew point lines to be seen without being cut off or expanding the x-axis limits","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IEoGCstUmz"}],"key":"rdqA3P4RUe"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"inlineCode","value":"skewt.ax.set_ylim(1000, 10)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"twrBiOpFDn"},{"type":"text","value":": sets the y-axis limits to 1000 hPa at the bottom and 10 hPa at the top to include the entire sounding","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"P63ekZDcWh"}],"key":"SPJLVVvgv3"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"skewt.plot_barbs(p[::5], u[::5], v[::5])","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EMLa1wKuZw"},{"type":"text","value":": plots every fifth wind barb to reduce clutter, also removes limiting the wind barbs to pressure levels greater than 100 hPa","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SNYKyY4fhR"}],"key":"YzY0aUYX4m"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"reduced the linewidth of the dry adiabats, moist adiabats, and mixing ratio lines to 0.5","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aCWimZ2zUH"}],"key":"v2KZRKfeOV"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"added axes labels","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jnTMUssLB4"}],"key":"zNq5VyypRQ"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"added a title including the station name and date of the sounding pulled from the data","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"eIGIgy99wg"}],"key":"uBIH4K8Gt0"}],"key":"gpLMz3ri50"}],"key":"J1PxFTiAFW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Additional Skew-T Options","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gv8s5mDx1B"}],"identifier":"additional-skew-t-options","label":"Additional Skew-T Options","html_id":"additional-skew-t-options","implicit":true,"key":"N6bz4jKEO6"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"There are a few additional options that can be used to customize the appearance of the Skew-T plot that we haven’t covered here. For more information, check out the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sUsCYcHAYC"},{"type":"link","url":"https://unidata.github.io/MetPy/latest/api/generated/metpy.plots.SkewT.html","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"MetPy documentation","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HXwjbI5qQw"}],"urlSource":"https://unidata.github.io/MetPy/latest/api/generated/metpy.plots.SkewT.html","key":"OqorfBlfYp"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"aLtjTVicKw"}],"key":"DgJtIIpRBQ"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here’s a few quick examples of some of those additional options:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"qZW2C7XgtY"}],"key":"bp9FvZmwvR"}],"key":"pSvfh4OS9u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(15, 4))\n\n# set up some subplots\nskewt_plots = []\nfor i in range(0,4):\n    skewt_plots.append(SkewT(fig=fig, subplot=(1,4,i+1), rotation=45))\n    skewt_plots[i].plot(p, T, 'r') # air temperature\n    skewt_plots[i].plot(p, Td, 'b') # dew point\n    skewt_plots[i].plot_barbs(p[::5], u[::5], v[::5], length=5, linewidth=0.5)\n    skewt_plots[i].plot_dry_adiabats(linewidth=0.5)\n    skewt_plots[i].plot_moist_adiabats(linewidth=0.5)\n    skewt_plots[i].plot_mixing_lines(linewidth=0.5)\n    skewt_plots[i].ax.set_xlabel('')\n    skewt_plots[i].ax.set_ylabel('')\n\n# calculate LCL and parcel profile\nlcl_p, lcl_t = mpcalc.lcl(p[0]*units.hPa, T[0]*units.degC, Td[0]*units.degC)\nlcl_prof = mpcalc.parcel_profile(p*units.hPa, T[0]*units.degC, Td[0]*units.degC).to('degC')\n\n\n# LCL and parcel profile skew-T\n# At what point an air parcel lifted as a dry parcel becomes saturated\nskewt_plots[0].ax.set_title('LCL and Parcel Profile')\nskewt_plots[0].plot(p, lcl_prof, 'k')\nskewt_plots[0].plot(lcl_p, lcl_t, 'ko') # Lifted Condensation Level\n\n\n# add constant temperature line at t=0\nskewt_plots[1].ax.set_title('Constant T Line at 0$^\\circ$C')\nskewt_plots[1].ax.axvline(0, color='k', ls='--')\n\n\n# shade CAPE and CIN\n# Area above and below the Level of Free Convection  (LFC) - where the temeprature line crosses the moist adiabat\n# Updraft energy for thunderstorms (CAPE) and energy needed for the storm to start (CIN)\nskewt_plots[2].ax.set_title('Shade CAPE and CIN')\nskewt_plots[2].plot(p, lcl_prof, 'k')\nskewt_plots[2].shade_cin(p*units.hPa, T*units.degC, lcl_prof, Td*units.degC)  # Convective INhibition\nskewt_plots[2].shade_cape(p*units.hPa, T*units.degC, lcl_prof) # Convective Available Potential Energy\n\n\n# Hodograph\n#  A line that connects the tips of wind vectors between two atmospheric heights\n# # Used for understanding wind sheer\nskewt_plots[3].ax.set_title('Hodograph')\nax_hod = inset_axes(skewt_plots[3].ax, '30%', '30%')\nhod = Hodograph(ax_hod, component_range=50)\nhod.add_grid(increment=10)\nhod.plot_colormapped(u, v, h)","key":"glhB8slmEz"},{"type":"output","id":"KHzDN0WUB_rl6LR9elL9T","data":[{"output_type":"stream","name":"stderr","text":"<>:29: SyntaxWarning: invalid escape sequence '\\c'\n<>:29: SyntaxWarning: invalid escape sequence '\\c'\n/tmp/ipykernel_3441/2729522150.py:29: SyntaxWarning: invalid escape sequence '\\c'\n  skewt_plots[1].ax.set_title('Constant T Line at 0$^\\circ$C')\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x400 with 5 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f95da3d2766ccb1960c04eee18a70162","path":"/advanced-viz-cookbook/build/f95da3d2766ccb1960c04eee18a70162.png"}}}],"key":"p4ELDPVCf3"}],"key":"aCDydAFROh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"piF0GuESHz"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"BR3AeYpib5"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Skew-T plots are a useful tool for visualizing and understanding sounding data. Creating Skew-T plots in python might seem challenging given their unique structural characteristics, but ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"D8pnaPCpo6"},{"type":"inlineCode","value":"MetPy","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"PTp3vsx6pF"},{"type":"text","value":"’s ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XGjKf1FLjy"},{"type":"inlineCode","value":"SkewT","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"UYVt1Bx63V"},{"type":"text","value":" module greatly simplifies the process.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gypvnTYWas"}],"key":"hzX9wnrDKB"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"What’s next?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"C64IMmOC34"}],"identifier":"whats-next","label":"What’s next?","html_id":"whats-next","implicit":true,"key":"pEgwh9chdW"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Next up let’s discuss ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gaf44M36mV"},{"type":"link","url":"/notebooks/spaghetti","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"spaghetti plots","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gvwotTJ1ta"}],"urlSource":"6-spaghetti","dataUrl":"/notebooks.spaghetti.json","internal":true,"protocol":"file","key":"C4ObwNm93G"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AmXriKEWOb"}],"key":"D5xwkZmm9Z"}],"key":"Onxv837jju"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TjvU4j1uSe"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"xwMdZWchDy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://weather.uwyo.edu/upperair/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Wyoming Upper Air","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ul6HuekBlz"}],"urlSource":"https://weather.uwyo.edu/upperair/","key":"pjxQrKoDIX"}],"key":"qL8wukFYKg"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://unidata.github.io/siphon/latest/examples/upperair/Wyoming_Request.html","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Siphon","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"I3tJW5OTa9"}],"urlSource":"https://unidata.github.io/siphon/latest/examples/upperair/Wyoming_Request.html","key":"jkd65cIXkL"}],"key":"mxxM7Pq8T4"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://unidata.github.io/MetPy/latest/api/generated/metpy.plots.SkewT.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"MetPy’s SkewT documentation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Wf2tONi7oL"}],"urlSource":"https://unidata.github.io/MetPy/latest/api/generated/metpy.plots.SkewT.html","key":"nnxx3jafEe"}],"key":"OOYaZtyFAh"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://www.noaa.gov/jetstream","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"NOAA’s JetStream","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"JRoJcecaZu"}],"urlSource":"https://www.noaa.gov/jetstream","key":"yADcJSpKDH"},{"type":"text","value":"’s ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AYMA79IFmo"},{"type":"link","url":"https://www.noaa.gov/jetstream/upperair/skew-t-plots","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Skew-T Plot","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pSN9RqBKt9"}],"urlSource":"https://www.noaa.gov/jetstream/upperair/skew-t-plots","key":"GnNLtJI35N"},{"type":"text","value":" page","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WdQuR4QEVz"}],"key":"XfjzV6qW3y"}],"key":"CDphOdV5zH"}],"key":"kBSt3HgOuF"}],"key":"NGPtyayOtM"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Taylor Diagrams","url":"/notebooks/taylor-diagrams","group":"Specialty Plots"},"next":{"title":"Spaghetti Plots","url":"/notebooks/spaghetti","group":"Visualization of Structured Grids"}}},"domain":"http://localhost:3000"}